---
标题：自定义角色
---

在Rancher中，_roles_确定用户可以在集群或项目中执行哪些操作。

请注意，_roles_与_permissions_不同，后者决定了您可以访问哪些集群和项目。

本节涵盖以下主题：

- [先决条件](＃prerequisites)
- [为集群或项目创建自定义角色](＃为集群或项目创建自定义角色)
- [创建从现有角色复制规则的自定义全局角色](＃creating-a-custom-global-role-ofcopysrules-an-existingrole)
- [删除自定义全局角色](＃deleting-a-custom-global-role)
- [将自定义全局角色分配给组](＃assigning-a-custom-global-role-to-a-group)

### 先决条件

要完成此页面上的任务，需要以下权限之一：

- [管理员全局权限](/docs/admin-settings/rbac/global-permissions/)。
- [自定义全局权限](/docs/admin-settings/rbac/global-permissions/＃custom-global-permissions)和[管理角色](/docs/admin-settings/rbac/global-permissions/＃global-权限参考)角色分配。

### 为集群或项目创建自定义角色

当Rancher开箱即用时提供了一组默认用户角色，您还可以创建默认自定义角色，以向用户提供Rancher中非常特定的权限。

添加自定义角色的步骤因Rancher的版本而异。

 标签
 标签`Rancher v2.0.7 +`

1. 在`全局`视图中，从主菜单中选择`安全性>角色`。

2. 选择一个选项卡以确定要添加的角色的范围。选项卡是：

- **集群：** 在向_only_集群添加/管理成员时，该角色对于分配有效。
- **项目：** 在向_only_项目添加/管理成员时，该角色对分配有效。

1. 单击`添加群集/项目角色`。

2. **名称** 角色。

3. 可选：选择`群集/项目创建者默认值`选项，以在用户创建新群集或项目时将此角色分配给用户。使用此功能，可以扩展或限制群集/项目创建者的默认角色。

    > 开箱即用，`集群创建者默认`和`项目创建者默认`角色分别是`集群所有者`和`项目所有者`。

4. 使用`授予资源`选项将单个[Kubernetes API端点](https://kubernetes.io/docs/reference/)分配给角色。

    > 查看与Rancher创建的默认角色相关的资源时，如果一个订单项上有多个Kubernetes API资源，则该资源将附加`(Custom)`。这些不是自定义资源，仅表示有多个Kubernetes API资源作为一种资源。

    您还可以选择单独的cURL方法(`创建`，`删除`，`获取`等)，以供您分配的每个端点使用。

5. 使用`从角色继承`选项将单个Rancher角色分配给您的自定义角色。注意：当自定义角色从父角色继承时，只有删除子角色才能删除父角色。

6. 单击**创建**。

 /标签 标签` v2.0.7之前的Rancher`

1. 在`全局`视图中，从主菜单中选择`安全性>角色`。

2. 单击`添加角色`。

3. **名称** 角色。

4. 选择是否将角色设置为[已锁定](/docs/admin-settings/rbac/locked-roles/)。

    > **注意：**无法将锁定角色分配给用户。

5. 在`上下文`下拉菜单中，选择分配给用户的角色范围。上下文是：

    - **全部：**不论上下文如何，用户都可以使用分配的角色。在向集群或项目添加/管理成员时，此角色对于分配有效。

    - **集群：**当向_only_集群添加/管理成员时，此角色可用于分配。

    - **项目：**当将成员添加/管理到_only_项目中时，此角色可用于分配。

6. 使用`授予资源`选项将单个[Kubernetes API端点](https://kubernetes.io/docs/reference/)分配给角色。

    >查看与Rancher创建的默认角色相关的资源时，如果一个订单项上有多个Kubernetes API资源，则该资源将附加`(Custom)`。这些不是自定义资源，仅表示有多个Kubernetes API资源作为一种资源。

    您还可以选择单独的cURL方法(`创建`，`删除`，`获取`等)，以供您分配的每个端点使用。
    
7. 使用`从角色继承`选项将单个Rancher角色分配给您的自定义角色。注意：当自定义角色从父角色继承时，只有删除子角色才能删除父角色。

8. 单击**创建**。

 /标签 /标签

### 创建从现有角色复制规则的自定义全局角色

_自v2.4.0-alpha1起可用

如果您有一组需要在Rancher中具有相同访问级别的人员，则可以节省时间来创建自定义全局角色，该角色将来自另一个角色(例如管理员角色)的所有规则复制到一个新角色中。这使您仅可以配置现有角色和新角色之间的变体。

然后，可以将自定义全局角色分配给用户或组，以便自定义全局角色在用户首次登录Rancher时生效。

要基于现有角色创建自定义全局角色，

1. 转到`全局`视图，然后单击`安全性`>`角色`。**
2. 在`全局`选项卡上，转到自定义全局角色将基于的角色。单击**省略号(...)>克隆。**
3. 输入角色名称。
4. 可选：要为新用户分配自定义角色默认设置，请转到`新用户默认设置`部分，然后单击`是：新用户的默认角色。`
5. 在`授予资源`部分中，选择将为具有自定义角色的用户启用的Kubernetes资源操作。
6. 点击**保存。**

### 创建不复制其他角色规则的自定义全局角色

_自v2.4.0-alpha1起可用

自定义全局角色不必基于现有角色。要通过选择该角色应允许的特定Kubernetes资源操作来创建自定义全局角色，请执行以下步骤：

1. 转到`全局`视图，然后单击`安全性`>`角色`。**
2. 在`全局`选项卡上，单击`添加全局角色`。
3. 输入角色名称。
4. 可选：要为新用户分配自定义角色默认设置，请转到`新用户默认设置`部分，然后单击`是：新用户的默认角色。`
5. 在`授予资源`部分中，选择将为具有自定义角色的用户启用的Kubernetes资源操作。
6. 点击**保存。**

### 删除自定义全局角色

_自v2.4.0-alpha1起可用

删除自定义全局角色时，具有此自定义角色的所有全局角色绑定都将被删除。

如果仅为用户分配一个自定义全局角色，并且删除了该角色，则该用户将失去对Rancher的访问权限。为了使用户重新获得访问权限，管理员需要编辑用户并应用新的全局权限。

可以删除自定义全局角色，但是不能删除内置角色。

要删除自定义全局角色，

1. 转到`全局`视图，然后单击`安全性`>`角色`。**
2. 在`全局`选项卡上，转到应删除的自定义全局角色，然后单击`省略号(…)>删除`。
3. 单击**删除。**

### 将自定义全局角色分配给组

_自v2.4.0-alpha1起可用

如果您有一组需要在Rancher中具有相同访问级别的人员，则可以节省创建自定义全局角色的时间。将角色分配给组后，组中的用户首次登录Rancher时将具有适当的访问级别。

当组中的用户登录时，默认情况下，他们将获得内置的`标准用户`全局角色。他们还将获得分配给其组的权限。

如果将用户从外部身份验证提供程序组中删除，他们将失去分配给该组的自定义全局角色的权限。他们将继续扮演各自的标准用户角色。

> **先决条件：** 您只能在以下情况下为组分配全局角色：
> - 您已经设置了[外部身份验证提供程序](/docs/admin-settings/authentication/＃external-vs-local-authentication)
> - 外部身份验证提供程序支持[用户组](/docs/admin-settings/authentication/user-groups/)
> - 您已经通过身份验证提供程序建立了至少一个用户组

要将自定义全局角色分配给组，请按照下列步骤操作：

1. 从`全局`视图中，转到`安全性`>`组`。
2. 单击`分配全局角色`。
3. 在`选择要添加的组`字段中，选择将被分配自定义全局角色的现有组。
4. 在`自定义`部分中，选择将分配给该组的任何自定义全局角色。
5. 可选：在`全局权限`或`内置`部分中，选择组应具有的任何其他权限。
6. 点击**创建。**

**结果：** 自定义全局角色将在组中的用户登录到Rancher时生效。
